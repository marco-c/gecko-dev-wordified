#
-
*
-
Mode
:
makefile
-
*
-
#
#
This
Source
Code
Form
is
subject
to
the
terms
of
the
Mozilla
Public
#
License
v
.
2
.
0
.
If
a
copy
of
the
MPL
was
not
distributed
with
this
#
file
You
can
obtain
one
at
http
:
/
/
mozilla
.
org
/
MPL
/
2
.
0
/
.
ifeq
(
(
MAKE_VERSION
)
)
(
error
GNU
Make
is
required
)
endif
make_min_ver
:
=
3
.
81
ifneq
(
(
make_min_ver
)
(
firstword
(
sort
(
make_min_ver
)
(
MAKE_VERSION
)
)
)
)
(
error
GNU
Make
(
make_min_ver
)
or
higher
is
required
)
endif
DASH_R
=
-
r
#
Define
keyword
generator
before
rules
.
mk
see
bug
323979
comment
50
USE_HOST_CXX
=
1
include
(
topsrcdir
)
/
config
/
rules
.
mk
CFLAGS
+
=
(
MOZ_ZLIB_CFLAGS
)
ifeq
(
(
OS_ARCH
)
SunOS
)
ifeq
(
(
TARGET_CPU
)
sparc
)
ifneq
(
(
CC_TYPE
)
clang
-
cl
)
CFLAGS
+
=
-
mcpu
=
v9
CXXFLAGS
+
=
-
mcpu
=
v9
endif
#
!
clang
-
cl
endif
endif
install
:
:
(
MAKE
)
-
C
build
install
(
MAKE
)
-
C
shell
install
ifdef
HAVE_DTRACE
javascript
-
trace
.
h
:
(
srcdir
)
/
devtools
/
javascript
-
trace
.
d
dtrace
-
x
nolibs
-
h
-
s
(
srcdir
)
/
devtools
/
javascript
-
trace
.
d
-
o
javascript
-
trace
.
h
.
in
sed
-
e
'
s
/
if
_DTRACE_VERSION
/
ifdef
INCLUDE_MOZILLA_DTRACE
/
'
\
-
e
'
/
const
/
!
s
/
char
\
*
/
const
char
*
/
g
'
\
javascript
-
trace
.
h
.
in
>
javascript
-
trace
.
h
#
We
can
'
t
automatically
generate
dependencies
on
auto
-
generated
headers
;
#
we
have
to
list
them
explicitly
.
(
addsuffix
.
(
OBJ_SUFFIX
)
Probes
jsinterp
jsobj
)
:
(
CURDIR
)
/
javascript
-
trace
.
h
ifneq
(
(
OS_ARCH
)
Darwin
)
DTRACE_PROBE_OBJ
=
js
-
dtrace
.
(
OBJ_SUFFIX
)
(
LIBRARY
)
:
(
DTRACE_PROBE_OBJ
)
(
DTRACE_PROBE_OBJ
)
:
(
srcdir
)
/
devtools
/
javascript
-
trace
.
d
(
OBJS
)
dtrace
-
x
nolibs
-
G
-
C
-
s
<
-
o
(
filter
-
out
<
^
)
OBJS
+
=
(
DTRACE_PROBE_OBJ
)
endif
#
OS_ARCH
!
=
Darwin
endif
#
HAVE_DTRACE
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
#
Generating
source
package
tarballs
#
(
only
possible
when
tar
is
found
)
ifneq
(
(
TAR
)
)
source
-
package
:
SRCDIR
=
(
srcdir
)
\
DIST
=
(
DIST
)
\
MKDIR
=
(
MKDIR
)
\
TAR
=
(
TAR
)
\
M4
=
(
M4
)
\
AWK
=
(
AWK
)
\
MOZJS_MAJOR_VERSION
=
(
MOZJS_MAJOR_VERSION
)
\
MOZJS_MINOR_VERSION
=
(
MOZJS_MINOR_VERSION
)
\
MOZJS_PATCH_VERSION
=
(
MOZJS_PATCH_VERSION
)
\
MOZJS_ALPHA
=
(
MOZJS_ALPHA
)
\
(
srcdir
)
/
make
-
source
-
package
.
sh
endif
