<
!
doctype
html
>
<
html
>
<
head
>
<
meta
charset
=
"
utf
-
8
"
>
<
meta
name
=
"
timeout
"
content
=
"
long
"
>
<
title
>
Deleting
grapheme
cluster
<
/
title
>
<
script
src
=
"
/
resources
/
testharness
.
js
"
>
<
/
script
>
<
script
src
=
"
/
resources
/
testharnessreport
.
js
"
>
<
/
script
>
<
script
src
=
"
.
.
/
.
.
/
editing
/
include
/
editor
-
test
-
utils
.
js
"
>
<
/
script
>
<
/
head
>
<
body
>
<
div
contenteditable
>
<
/
div
>
<
script
>
"
use
strict
"
;
const
editingHost
=
document
.
querySelector
(
"
div
[
contenteditable
]
"
)
;
const
utils
=
new
EditorTestUtils
(
editingHost
)
;
const
flag
=
"
\
u
{
1F1E8
}
\
u
{
1F1F3
}
"
;
const
halfWidthKatakana
=
"
\
uFF76
\
uFF9E
"
;
const
rainbowFlag
=
"
\
u
{
1F3F3
}
\
u
{
FE0F
}
\
u
{
200D
}
\
u
{
1F308
}
"
;
const
family
=
"
\
u
{
1F468
}
\
u
{
200D
}
\
u
{
1F469
}
\
u
{
200D
}
\
u
{
1F467
}
"
;
const
tests
=
[
{
name
:
"
Backwards
delete
grapheme
cluster
"
initialInnerHTML
:
a
{
flag
}
[
]
b
command
:
"
delete
"
expected
:
"
ab
"
}
{
name
:
"
Forwards
delete
grapheme
cluster
"
initialInnerHTML
:
a
[
]
{
flag
}
b
command
:
"
forwarddelete
"
expected
:
"
ab
"
}
{
name
:
"
Backwards
delete
half
-
width
katakana
"
initialInnerHTML
:
{
halfWidthKatakana
}
[
]
command
:
"
delete
"
expected
:
"
\
uFF76
"
}
{
name
:
"
Forwards
delete
half
-
width
katakana
"
initialInnerHTML
:
[
]
{
halfWidthKatakana
}
command
:
"
forwarddelete
"
expected
:
[
"
"
"
<
br
>
"
]
}
{
name
:
"
Backwards
delete
rainbow
flag
"
initialInnerHTML
:
{
rainbowFlag
}
[
]
command
:
"
delete
"
expected
:
[
"
"
"
<
br
>
"
]
}
{
name
:
"
Forwards
delete
rainbow
flag
"
initialInnerHTML
:
[
]
{
rainbowFlag
}
command
:
"
forwarddelete
"
expected
:
[
"
"
"
<
br
>
"
]
}
{
name
:
"
Backwards
delete
rainbow
flag
around
text
"
initialInnerHTML
:
start
{
rainbowFlag
}
[
]
end
command
:
"
delete
"
expected
:
"
startend
"
}
{
name
:
"
Forwards
delete
rainbow
flag
around
text
"
initialInnerHTML
:
start
[
]
{
rainbowFlag
}
end
command
:
"
forwarddelete
"
expected
:
"
startend
"
}
{
name
:
"
Backwards
delete
family
emoji
"
initialInnerHTML
:
{
family
}
[
]
command
:
"
delete
"
expected
:
[
"
"
"
<
br
>
"
]
}
{
name
:
"
Forwards
delete
family
emoji
"
initialInnerHTML
:
[
]
{
family
}
command
:
"
forwarddelete
"
expected
:
[
"
"
"
<
br
>
"
]
}
]
;
for
(
const
t
of
tests
)
{
test
(
(
)
=
>
{
utils
.
setupEditingHost
(
t
.
initialInnerHTML
)
;
document
.
execCommand
(
t
.
command
)
;
if
(
Array
.
isArray
(
t
.
expected
)
)
{
assert_in_array
(
editingHost
.
innerHTML
t
.
expected
)
;
}
else
{
assert_equals
(
editingHost
.
innerHTML
t
.
expected
)
;
}
}
t
.
name
)
;
}
<
/
script
>
<
/
body
>
<
/
html
>
