From
:
Michael
Froman
<
mjfroman
mac
.
com
>
Date
:
Fri
8
Aug
2025
14
:
40
:
15
-
0500
Subject
:
(
tmp
-
cherry
-
pick
)
Revert
"
IWYU
modules
/
video_capture
/
"
(
2b5eccc4f2
)
This
reverts
commit
55b5f0e429a572aabb28ab3b078f19a4365c1028
.
Reason
for
revert
:
breaks
downstream
projects
.
Bug
:
webrtc
:
42226242
Original
change
'
s
description
:
>
IWYU
modules
/
video_capture
/
>
>
without
platform
-
specific
subdirectories
first
.
Done
>
using
>
ls
modules
/
video_capture
/
*
.
{
h
cc
}
|
xargs
tools_webrtc
/
iwyu
/
apply
-
include
-
cleaner
|
xargs
tools_webrtc
/
iwyu
/
apply
-
include
-
cleaner
>
followed
by
>
tools_webrtc
/
gn_check_autofix
.
py
-
C
out
/
Default
/
>
and
git
cl
format
>
>
Manual
changes
:
>
-
video_capture_impl
.
cc
:
use
C
+
+
headers
>
>
Bug
:
webrtc
:
42226242
>
Change
-
Id
:
I2477021f0cfd9045cae4c5a789c4983a194ef7ef
>
Reviewed
-
on
:
https
:
/
/
webrtc
-
review
.
googlesource
.
com
/
c
/
src
/
+
/
391262
>
Reviewed
-
by
:
Ilya
Nikolaevskiy
<
ilnik
webrtc
.
org
>
>
Reviewed
-
by
:
Danil
Chapovalov
<
danilchap
webrtc
.
org
>
>
Commit
-
Queue
:
Philipp
Hancke
<
phancke
meta
.
com
>
>
Cr
-
Commit
-
Position
:
refs
/
heads
/
main
{
#
44628
}
Bug
:
webrtc
:
42226242
No
-
Presubmit
:
true
No
-
Tree
-
Checks
:
true
No
-
Try
:
true
Change
-
Id
:
If01a94c3699bc7d4bdadd23fef0416685544b191
Reviewed
-
on
:
https
:
/
/
webrtc
-
review
.
googlesource
.
com
/
c
/
src
/
+
/
391720
Reviewed
-
by
:
Jeremy
Leconte
<
jleconte
google
.
com
>
Owners
-
Override
:
Ilya
Nikolaevskiy
<
ilnik
webrtc
.
org
>
Bot
-
Commit
:
rubber
-
stamper
appspot
.
gserviceaccount
.
com
<
rubber
-
stamper
appspot
.
gserviceaccount
.
com
>
Commit
-
Queue
:
Ilya
Nikolaevskiy
<
ilnik
webrtc
.
org
>
Cr
-
Commit
-
Position
:
refs
/
heads
/
main
{
#
44632
}
-
-
-
modules
/
video_capture
/
BUILD
.
gn
|
2
-
-
.
.
.
/
video_capture
/
raw_video_sink_interface
.
h
|
4
-
-
-
-
modules
/
video_capture
/
video_capture
.
h
|
4
-
-
-
-
modules
/
video_capture
/
video_capture_defines
.
h
|
3
+
-
-
.
.
.
/
video_capture
/
video_capture_factory
.
cc
|
2
-
-
modules
/
video_capture
/
video_capture_factory
.
h
|
1
+
.
.
.
/
video_capture_factory_null
.
cc
|
2
-
-
modules
/
video_capture
/
video_capture_impl
.
cc
|
19
+
+
+
+
-
-
-
-
-
-
-
-
-
-
-
-
-
-
-
modules
/
video_capture
/
video_capture_impl
.
h
|
2
-
-
.
.
.
/
video_capture
/
video_capture_options
.
cc
|
3
-
-
-
10
files
changed
6
insertions
(
+
)
36
deletions
(
-
)
diff
-
-
git
a
/
modules
/
video_capture
/
BUILD
.
gn
b
/
modules
/
video_capture
/
BUILD
.
gn
index
c3e0e5af71
.
.
e5e74c9fc3
100644
-
-
-
a
/
modules
/
video_capture
/
BUILD
.
gn
+
+
+
b
/
modules
/
video_capture
/
BUILD
.
gn
-
28
7
+
28
6
rtc_library
(
"
video_capture_module
"
)
{
]
deps
=
[
-
"
.
.
/
.
.
/
api
:
ref_count
"
"
.
.
/
.
.
/
api
:
scoped_refptr
"
"
.
.
/
.
.
/
api
:
sequence_checker
"
"
.
.
/
.
.
/
api
/
video
:
video_frame
"
-
56
7
+
55
6
if
(
!
build_with_chromium
|
|
is_linux
|
|
is_chromeos
)
{
visibility
=
[
"
*
"
]
deps
=
[
"
:
video_capture_module
"
-
"
.
.
/
.
.
/
api
:
make_ref_counted
"
"
.
.
/
.
.
/
api
:
scoped_refptr
"
"
.
.
/
.
.
/
api
:
sequence_checker
"
"
.
.
/
.
.
/
media
:
video_common
"
diff
-
-
git
a
/
modules
/
video_capture
/
raw_video_sink_interface
.
h
b
/
modules
/
video_capture
/
raw_video_sink_interface
.
h
index
a22ca9811d
.
.
094e9e20bd
100644
-
-
-
a
/
modules
/
video_capture
/
raw_video_sink_interface
.
h
+
+
+
b
/
modules
/
video_capture
/
raw_video_sink_interface
.
h
-
14
10
+
14
6
#
ifndef
MODULES_VIDEO_CAPTURE_RAW_VIDEO_SINK_INTERFACE_H_
#
define
MODULES_VIDEO_CAPTURE_RAW_VIDEO_SINK_INTERFACE_H_
-
#
include
<
cstddef
>
-
#
include
<
cstdint
>
-
-
#
include
"
api
/
video
/
video_rotation
.
h
"
#
include
"
modules
/
video_capture
/
video_capture_defines
.
h
"
namespace
webrtc
{
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture
.
h
b
/
modules
/
video_capture
/
video_capture
.
h
index
7707608dbc
.
.
fe5c09bd87
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture
.
h
+
+
+
b
/
modules
/
video_capture
/
video_capture
.
h
-
11
10
+
11
6
#
ifndef
MODULES_VIDEO_CAPTURE_VIDEO_CAPTURE_H_
#
define
MODULES_VIDEO_CAPTURE_VIDEO_CAPTURE_H_
-
#
include
<
cstdint
>
-
-
#
include
"
api
/
ref_count
.
h
"
-
#
include
"
api
/
video
/
video_frame
.
h
"
#
include
"
api
/
video
/
video_rotation
.
h
"
#
include
"
api
/
video
/
video_sink_interface
.
h
"
#
include
"
modules
/
video_capture
/
raw_video_sink_interface
.
h
"
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture_defines
.
h
b
/
modules
/
video_capture
/
video_capture_defines
.
h
index
f814e4e7f5
.
.
63534600a9
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture_defines
.
h
+
+
+
b
/
modules
/
video_capture
/
video_capture_defines
.
h
-
11
8
+
11
7
#
ifndef
MODULES_VIDEO_CAPTURE_VIDEO_CAPTURE_DEFINES_H_
#
define
MODULES_VIDEO_CAPTURE_VIDEO_CAPTURE_DEFINES_H_
-
#
include
<
cstdint
>
-
+
#
include
"
api
/
video
/
video_frame
.
h
"
#
include
"
common_video
/
libyuv
/
include
/
webrtc_libyuv
.
h
"
namespace
webrtc
{
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture_factory
.
cc
b
/
modules
/
video_capture
/
video_capture_factory
.
cc
index
d7fa0fa26e
.
.
8354067f93
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture_factory
.
cc
+
+
+
b
/
modules
/
video_capture
/
video_capture_factory
.
cc
-
10
8
+
10
6
#
include
"
modules
/
video_capture
/
video_capture_factory
.
h
"
-
#
include
"
api
/
scoped_refptr
.
h
"
-
#
include
"
modules
/
video_capture
/
video_capture
.
h
"
#
include
"
modules
/
video_capture
/
video_capture_impl
.
h
"
namespace
webrtc
{
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture_factory
.
h
b
/
modules
/
video_capture
/
video_capture_factory
.
h
index
e669470e35
.
.
c24eaf559f
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture_factory
.
h
+
+
+
b
/
modules
/
video_capture
/
video_capture_factory
.
h
-
16
6
+
16
7
#
include
"
api
/
scoped_refptr
.
h
"
#
include
"
modules
/
video_capture
/
video_capture
.
h
"
+
#
include
"
modules
/
video_capture
/
video_capture_defines
.
h
"
#
include
"
rtc_base
/
system
/
rtc_export
.
h
"
namespace
webrtc
{
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture_factory_null
.
cc
b
/
modules
/
video_capture
/
video_capture_factory_null
.
cc
index
4dbc7b9f5c
.
.
77b7f4b75e
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture_factory_null
.
cc
+
+
+
b
/
modules
/
video_capture
/
video_capture_factory_null
.
cc
-
8
8
+
8
6
*
be
found
in
the
AUTHORS
file
in
the
root
of
the
source
tree
.
*
/
-
#
include
"
api
/
scoped_refptr
.
h
"
-
#
include
"
modules
/
video_capture
/
video_capture
.
h
"
#
include
"
modules
/
video_capture
/
video_capture_impl
.
h
"
namespace
webrtc
{
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture_impl
.
cc
b
/
modules
/
video_capture
/
video_capture_impl
.
cc
index
f12631c274
.
.
06f9bd3165
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture_impl
.
cc
+
+
+
b
/
modules
/
video_capture
/
video_capture_impl
.
cc
-
10
28
+
10
17
#
include
"
modules
/
video_capture
/
video_capture_impl
.
h
"
-
#
include
<
cstdint
>
-
#
include
<
cstdlib
>
-
#
include
<
cstring
>
+
#
include
<
stdlib
.
h
>
+
#
include
<
string
.
h
>
-
#
include
"
api
/
scoped_refptr
.
h
"
-
#
include
"
api
/
sequence_checker
.
h
"
#
include
"
api
/
video
/
i420_buffer
.
h
"
-
#
include
"
api
/
video
/
video_frame
.
h
"
-
#
include
"
api
/
video
/
video_rotation
.
h
"
-
#
include
"
api
/
video
/
video_sink_interface
.
h
"
+
#
include
"
api
/
video
/
video_frame_buffer
.
h
"
#
include
"
common_video
/
libyuv
/
include
/
webrtc_libyuv
.
h
"
-
#
include
"
libyuv
/
convert
.
h
"
-
#
include
"
libyuv
/
rotate
.
h
"
-
#
include
"
modules
/
video_capture
/
raw_video_sink_interface
.
h
"
#
include
"
modules
/
video_capture
/
video_capture_config
.
h
"
-
#
include
"
modules
/
video_capture
/
video_capture_defines
.
h
"
-
#
include
"
rtc_base
/
checks
.
h
"
#
include
"
rtc_base
/
logging
.
h
"
-
#
include
"
rtc_base
/
race_checker
.
h
"
-
#
include
"
rtc_base
/
synchronization
/
mutex
.
h
"
#
include
"
rtc_base
/
time_utils
.
h
"
#
include
"
rtc_base
/
trace_event
.
h
"
+
#
include
"
third_party
/
libyuv
/
include
/
libyuv
.
h
"
namespace
webrtc
{
namespace
videocapturemodule
{
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture_impl
.
h
b
/
modules
/
video_capture
/
video_capture_impl
.
h
index
d3ac5fe5ef
.
.
3ec832f871
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture_impl
.
h
+
+
+
b
/
modules
/
video_capture
/
video_capture_impl
.
h
-
23
14
+
23
12
#
include
"
api
/
video
/
video_frame
.
h
"
#
include
"
api
/
video
/
video_rotation
.
h
"
#
include
"
api
/
video
/
video_sink_interface
.
h
"
-
#
include
"
modules
/
video_capture
/
raw_video_sink_interface
.
h
"
#
include
"
modules
/
video_capture
/
video_capture
.
h
"
#
include
"
modules
/
video_capture
/
video_capture_config
.
h
"
#
include
"
modules
/
video_capture
/
video_capture_defines
.
h
"
#
include
"
rtc_base
/
race_checker
.
h
"
#
include
"
rtc_base
/
synchronization
/
mutex
.
h
"
#
include
"
rtc_base
/
system
/
rtc_export
.
h
"
-
#
include
"
rtc_base
/
thread_annotations
.
h
"
namespace
webrtc
{
diff
-
-
git
a
/
modules
/
video_capture
/
video_capture_options
.
cc
b
/
modules
/
video_capture
/
video_capture_options
.
cc
index
dd102df9db
.
.
64cd6216e7
100644
-
-
-
a
/
modules
/
video_capture
/
video_capture_options
.
cc
+
+
+
b
/
modules
/
video_capture
/
video_capture_options
.
cc
-
10
9
+
10
6
#
include
"
modules
/
video_capture
/
video_capture_options
.
h
"
-
#
include
"
api
/
make_ref_counted
.
h
"
-
#
include
"
api
/
scoped_refptr
.
h
"
-
#
if
defined
(
WEBRTC_USE_PIPEWIRE
)
#
include
"
modules
/
video_capture
/
linux
/
pipewire_session
.
h
"
#
endif
