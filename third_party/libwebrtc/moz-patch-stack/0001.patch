From
:
Jan
-
Ivar
Bruaroey
<
jan
-
ivar
users
.
noreply
.
github
.
com
>
Date
:
Fri
9
Feb
2024
16
:
50
:
58
-
0500
Subject
:
(
tmp
-
cherry
-
pick
)
Revert
"
Make
frame
transformer
MimeType
pure
virtual
again
"
(
be23ea4bb9
)
This
reverts
commit
3ea9fc4cd8135555360aafbfe788571d9e2f23f9
.
Reason
for
revert
:
Breaks
downstream
project
.
Original
change
'
s
description
:
>
Make
frame
transformer
MimeType
pure
virtual
again
>
>
after
both
audio
and
video
have
been
implemented
.
>
>
BUG
=
webrtc
:
15579
>
>
Change
-
Id
:
Ib52e8f67292259cbf7497a884672de72f3003282
>
Reviewed
-
on
:
https
:
/
/
webrtc
-
review
.
googlesource
.
com
/
c
/
src
/
+
/
326162
>
Commit
-
Queue
:
Philipp
Hancke
<
phancke
microsoft
.
com
>
>
Reviewed
-
by
:
Harald
Alvestrand
<
hta
webrtc
.
org
>
>
Reviewed
-
by
:
Tony
Herre
<
herre
google
.
com
>
>
Cr
-
Commit
-
Position
:
refs
/
heads
/
main
{
#
41114
}
BUG
=
webrtc
:
15579
No
-
Presubmit
:
true
No
-
Tree
-
Checks
:
true
No
-
Try
:
true
Change
-
Id
:
I9b4c9753e260aca98d24a40f32ce57d86a181ea2
Reviewed
-
on
:
https
:
/
/
webrtc
-
review
.
googlesource
.
com
/
c
/
src
/
+
/
326525
Reviewed
-
by
:
Harald
Alvestrand
<
hta
webrtc
.
org
>
Bot
-
Commit
:
rubber
-
stamper
appspot
.
gserviceaccount
.
com
<
rubber
-
stamper
appspot
.
gserviceaccount
.
com
>
Owners
-
Override
:
Mirko
Bonadei
<
mbonadei
webrtc
.
org
>
Commit
-
Queue
:
Mirko
Bonadei
<
mbonadei
webrtc
.
org
>
Cr
-
Commit
-
Position
:
refs
/
heads
/
main
{
#
41116
}
-
-
-
api
/
frame_transformer_interface
.
h
|
7
+
+
+
+
+
+
-
api
/
test
/
mock_transformable_audio_frame
.
h
|
3
-
-
-
2
files
changed
6
insertions
(
+
)
4
deletions
(
-
)
diff
-
-
git
a
/
api
/
frame_transformer_interface
.
h
b
/
api
/
frame_transformer_interface
.
h
index
94f8dab448
.
.
535659d49b
100644
-
-
-
a
/
api
/
frame_transformer_interface
.
h
+
+
+
b
/
api
/
frame_transformer_interface
.
h
-
13
6
+
13
7
#
include
<
memory
>
#
include
<
string
>
+
#
include
<
vector
>
#
include
"
api
/
ref_count
.
h
"
#
include
"
api
/
scoped_refptr
.
h
"
-
53
7
+
54
11
class
TransformableFrameInterface
{
/
/
sender
frames
to
allow
received
frames
to
be
directly
re
-
transmitted
on
/
/
other
PeerConnectionss
.
virtual
Direction
GetDirection
(
)
const
{
return
Direction
:
:
kUnknown
;
}
-
virtual
std
:
:
string
GetMimeType
(
)
const
=
0
;
+
virtual
std
:
:
string
GetMimeType
(
)
const
{
+
/
/
TODO
(
bugs
.
webrtc
.
org
/
15579
)
:
Change
this
to
pure
virtual
after
it
+
/
/
is
implemented
everywhere
.
+
return
"
unknown
/
unknown
"
;
+
}
}
;
class
TransformableVideoFrameInterface
:
public
TransformableFrameInterface
{
diff
-
-
git
a
/
api
/
test
/
mock_transformable_audio_frame
.
h
b
/
api
/
test
/
mock_transformable_audio_frame
.
h
index
584c77fa54
.
.
be703006ea
100644
-
-
-
a
/
api
/
test
/
mock_transformable_audio_frame
.
h
+
+
+
b
/
api
/
test
/
mock_transformable_audio_frame
.
h
-
11
8
+
11
6
#
ifndef
API_TEST_MOCK_TRANSFORMABLE_AUDIO_FRAME_H_
#
define
API_TEST_MOCK_TRANSFORMABLE_AUDIO_FRAME_H_
-
#
include
<
string
>
-
#
include
"
api
/
frame_transformer_interface
.
h
"
#
include
"
test
/
gmock
.
h
"
-
26
7
+
24
6
class
MockTransformableAudioFrame
:
public
TransformableAudioFrameInterface
{
MOCK_METHOD
(
uint8_t
GetPayloadType
(
)
(
const
override
)
)
;
MOCK_METHOD
(
uint32_t
GetSsrc
(
)
(
const
override
)
)
;
MOCK_METHOD
(
uint32_t
GetTimestamp
(
)
(
const
override
)
)
;
-
MOCK_METHOD
(
std
:
:
string
GetMimeType
(
)
(
const
override
)
)
;
MOCK_METHOD
(
rtc
:
:
ArrayView
<
const
uint32_t
>
GetContributingSources
(
)
