<
!
DOCTYPE
HTML
>
<
html
>
<
head
>
<
meta
charset
=
"
UTF
-
8
"
>
<
title
>
Service
worker
push
test
<
/
title
>
<
/
head
>
<
body
>
<
script
type
=
"
text
/
javascript
"
>
"
use
strict
"
;
let
registration
;
const
registerServiceWorker
=
async
function
(
)
{
await
new
Promise
(
resolve
=
>
{
const
perm
=
{
type
:
"
desktop
-
notification
"
allow
:
true
context
:
document
}
;
SpecialPowers
.
pushPermissions
(
[
perm
]
resolve
)
;
}
)
;
try
{
registration
=
await
navigator
.
serviceWorker
.
register
(
"
push
-
sw
.
js
"
)
;
dump
(
"
Push
service
worker
registered
\
n
"
)
;
}
catch
(
e
)
{
dump
(
"
Push
service
worker
not
registered
:
"
+
e
+
"
\
n
"
)
;
}
}
;
/
/
Helper
called
from
head
-
serviceworker
.
js
to
unregister
the
service
worker
.
window
.
getRegistration
=
function
(
)
{
return
registration
;
}
;
/
/
Register
the
service
worker
.
registerServiceWorker
(
)
;
<
/
script
>
<
/
body
>
<
/
html
>
