diff
-
-
git
a
/
expat
/
lib
/
xmlparse
.
c
b
/
expat
/
lib
/
xmlparse
.
c
-
-
-
a
/
expat
/
lib
/
xmlparse
.
c
2024
-
09
-
12
17
:
13
:
43
+
+
+
b
/
expat
/
lib
/
xmlparse
.
c
2024
-
09
-
12
17
:
14
:
15
-
486
16
+
486
23
static
enum
XML_Error
processXmlDecl
(
XML
static
enum
XML_Error
initializeEncoding
(
XML_Parser
parser
)
;
static
enum
XML_Error
doProlog
(
XML_Parser
parser
const
ENCODING
*
enc
const
char
*
s
const
char
*
end
int
tok
const
char
*
next
const
char
*
*
nextPtr
XML_Bool
haveMore
XML_Bool
allowClosingDoctype
enum
XML_Account
account
)
;
static
enum
XML_Error
processInternalEntity
(
XML_Parser
parser
ENTITY
*
entity
XML_Bool
betweenDecl
)
;
+
/
*
BEGIN
MOZILLA
CHANGE
(
Bug
1746996
-
Ensure
that
storeRawNames
is
always
called
)
*
/
+
static
enum
XML_Error
doContentInternal
(
XML_Parser
parser
int
startTagLevel
+
const
ENCODING
*
enc
const
char
*
start
+
const
char
*
end
const
char
*
*
endPtr
+
XML_Bool
haveMore
+
enum
XML_Account
account
)
;
+
/
*
END
MOZILLA
CHANGE
*
/
static
enum
XML_Error
doContent
(
XML_Parser
parser
int
startTagLevel
const
ENCODING
*
enc
const
char
*
start
const
char
*
end
const
char
*
*
endPtr
XML_Bool
haveMore
enum
XML_Account
account
)
;
static
enum
XML_Error
doCdataSection
(
XML_Parser
parser
const
ENCODING
*
enc
const
char
*
*
startPtr
const
char
*
end
const
char
*
*
nextPtr
XML_Bool
haveMore
enum
XML_Account
account
)
;
-
2747
20
+
2754
24
storeRawNames
(
XML_Parser
parser
)
{
}
static
enum
XML_Error
PTRCALL
contentProcessor
(
XML_Parser
parser
const
char
*
start
const
char
*
end
const
char
*
*
endPtr
)
{
enum
XML_Error
result
=
doContent
(
parser
0
parser
-
>
m_encoding
start
end
endPtr
(
XML_Bool
)
!
parser
-
>
m_parsingStatus
.
finalBuffer
XML_ACCOUNT_DIRECT
)
;
+
/
*
BEGIN
MOZILLA
CHANGE
(
Bug
1746996
-
Ensure
that
storeRawNames
is
always
called
)
*
/
+
#
if
0
if
(
result
=
=
XML_ERROR_NONE
)
{
if
(
!
storeRawNames
(
parser
)
)
return
XML_ERROR_NO_MEMORY
;
}
+
#
endif
+
/
*
END
MOZILLA
CHANGE
*
/
return
result
;
}
static
enum
XML_Error
PTRCALL
externalEntityInitProcessor
(
XML_Parser
parser
const
char
*
start
const
char
*
end
const
char
*
*
endPtr
)
{
enum
XML_Error
result
=
initializeEncoding
(
parser
)
;
if
(
result
!
=
XML_ERROR_NONE
)
-
2863
27
+
2874
46
externalEntityInitProcessor3
(
XML_Parser
static
enum
XML_Error
PTRCALL
externalEntityContentProcessor
(
XML_Parser
parser
const
char
*
start
const
char
*
end
const
char
*
*
endPtr
)
{
enum
XML_Error
result
=
doContent
(
parser
1
parser
-
>
m_encoding
start
end
endPtr
(
XML_Bool
)
!
parser
-
>
m_parsingStatus
.
finalBuffer
XML_ACCOUNT_ENTITY_EXPANSION
)
;
+
/
*
BEGIN
MOZILLA
CHANGE
(
Bug
1746996
-
Ensure
that
storeRawNames
is
always
called
)
*
/
+
#
if
0
+
if
(
result
=
=
XML_ERROR_NONE
)
{
+
if
(
!
storeRawNames
(
parser
)
)
+
return
XML_ERROR_NO_MEMORY
;
+
}
+
#
endif
+
/
*
END
MOZILLA
CHANGE
*
/
+
return
result
;
+
}
+
+
static
enum
XML_Error
+
doContent
(
XML_Parser
parser
int
startTagLevel
const
ENCODING
*
enc
+
const
char
*
s
const
char
*
end
const
char
*
*
nextPtr
+
XML_Bool
haveMore
enum
XML_Account
account
)
{
+
/
*
BEGIN
MOZILLA
CHANGE
(
Bug
1746996
-
Ensure
that
storeRawNames
is
always
called
)
*
/
+
enum
XML_Error
result
=
doContentInternal
(
parser
startTagLevel
enc
s
end
+
nextPtr
haveMore
account
)
;
if
(
result
=
=
XML_ERROR_NONE
)
{
if
(
!
storeRawNames
(
parser
)
)
return
XML_ERROR_NO_MEMORY
;
}
return
result
;
}
static
enum
XML_Error
-
doContent
(
XML_Parser
parser
int
startTagLevel
const
ENCODING
*
enc
-
const
char
*
s
const
char
*
end
const
char
*
*
nextPtr
-
XML_Bool
haveMore
enum
XML_Account
account
)
{
+
doContentInternal
(
XML_Parser
parser
int
startTagLevel
const
ENCODING
*
enc
+
const
char
*
s
const
char
*
end
const
char
*
*
nextPtr
+
XML_Bool
haveMore
enum
XML_Account
account
)
{
+
/
*
END
MOZILLA
CHANGE
*
/
/
*
save
one
level
of
indirection
*
/
DTD
*
const
dtd
=
parser
-
>
m_dtd
;
const
char
*
*
eventPP
;
const
char
*
*
eventEndPP
;
if
(
enc
=
=
parser
-
>
m_encoding
)
{
eventPP
=
&
parser
-
>
m_eventPtr
;
eventEndPP
=
&
parser
-
>
m_eventEndPtr
;
-
6029
20
+
6059
24
internalEntityProcessor
(
XML_Parser
parse
XML_ACCOUNT_DIRECT
)
;
}
else
{
parser
-
>
m_processor
=
contentProcessor
;
/
*
see
externalEntityContentProcessor
vs
contentProcessor
*
/
result
=
doContent
(
parser
parser
-
>
m_parentParser
?
1
:
0
parser
-
>
m_encoding
s
end
nextPtr
(
XML_Bool
)
!
parser
-
>
m_parsingStatus
.
finalBuffer
XML_ACCOUNT_DIRECT
)
;
+
/
*
BEGIN
MOZILLA
CHANGE
(
Bug
1746996
-
Ensure
that
storeRawNames
is
always
called
)
*
/
+
#
if
0
if
(
result
=
=
XML_ERROR_NONE
)
{
if
(
!
storeRawNames
(
parser
)
)
return
XML_ERROR_NO_MEMORY
;
}
+
#
endif
+
/
*
END
MOZILLA
CHANGE
*
/
return
result
;
}
}
static
enum
XML_Error
PTRCALL
errorProcessor
(
XML_Parser
parser
const
char
*
s
const
char
*
end
const
char
*
*
nextPtr
)
{
UNUSED_P
(
s
)
;
